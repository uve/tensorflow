See https://github.com/uve/models/tree/master/official/mnist/mnist_eager.py
